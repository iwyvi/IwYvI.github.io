<!DOCTYPE html>
<html lang="zh-cn">

  
<head lang="zh-CN">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="renderer" content="webkit|ie-comp|ie-stand">
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta name="format-detection" content="telephone=no"/>
  <meta name="apple-mobile-app-status-bar-style" content="black" />
  <meta name="apple-touch-fullscreen" content="YES" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0,  minimum-scale=1.0, maximum-scale=1.0" />
  <meta name="msapplication-tap-highlight" content="no">

  <title>【译】深入了解CSS自定义属性 | IwYvI</title>
  <meta name="generator" content="IwYvI">
  <meta name="author" content="iwyvi">
  <meta name="description" content="
    【翻译】《CSS custom properties (native variables) In-Depth》：CSS自定义属性是一项新的CSS特性，它是一种在CSS中定义的变量，我们可以用这些变量实现一些新的功能，同时CSS自定义属性也提供了CSS与JS交互的新方式，与其他CSS预处理器也能做到完美配合。
    " />
  <meta name="keywords" content="" />

  <link rel="stylesheet" href="/css/style.css" type="text/css">
<!--   <link rel="canonical" href="{{ page.url | replace:'index.html','' | prepend: site.baseurl | prepend: site.url }}"> -->
  <link rel="alternate" href="/atom.xml" title="IwYvI" type="application/atom+xml">
</head>


  <body>

    <div class="background">
  <div class="ribbon"></div>
  <div class="tableCard"></div>
</div>
<div class="nav">
  <table>
    <tr>
      
        <td><a href="/.">首页</a></td>
      
        <td><a href="/archives/">文章</a></td>
      
        <td><a href="/works/">作品</a></td>
      
        <td><a href="/about/">关于</a></td>
      
    </tr>
    
      <tr>
        
          <td></td>
        
          <td></td>
        
          <td></td>
        
          <td></td>
        
      </tr>
    
      <tr>
        
          <td></td>
        
          <td></td>
        
          <td></td>
        
          <td></td>
        
      </tr>
    
      <tr>
        
          <td></td>
        
          <td></td>
        
          <td></td>
        
          <td></td>
        
      </tr>
    
      <tr>
        
          <td></td>
        
          <td></td>
        
          <td></td>
        
          <td></td>
        
      </tr>
    
  </table>
</div>
<div class="container">
  <div class="header">
    <div class="headerBackground">
      <div class="headerBackgroundImg"></div>
    </div>
    <div class="headerContent">
      <div class="avatar" alt="avatar">
        <a href="/">
          <img src="/img/avatar.jpg" alt="avatar">
        </a>
      </div>
      <div class="blogTitle">
        <h2>IwYvI</h2>
        <p>干了这碗鸡汤</p>
      </div>
    </div>
  </div>
  <div class="main">
    <div class="mainBackground">
      <div class="mainBackgroundLeft"></div>
      <div class="mainBackgroundRight">
        <div class="mainBackgroundCode">
<!-- 这段代码是电影《极乐空间》空站重新启动的代码，原文在《Intel Architecture Software Developer’s Manual Volume 3: System Programming》8-24页 -->
          <pre>; fixup GDT base in descriptor
 MOV ECX,EDX
 MOV [EDX].bas_0_15+GDT_DESC_OFF,CX
 ROR ECX,16
 MOV [EDX].bas_16_23+GDT_DESC_OFF,CL
 MOV [EDX].bas_24_31+GDT_DESC_OFF,CH

 ; copy EPROM IDT to ram at:
 ; RAM_START+size(STARTUP_DATA)+SIZE (EPROM GDT)
 MOV ECX, CS_BASE
 ADD ECX, OFFSET (IDT_EPROM)
 MOV ESI, [ECX].table_linear
 MOV EDI,EAX
 MOVZX ECX, [ECX].table_lim
 MOV APP_IDT_ram[EBX].table_lim,CX
 INC ECX
 MOV APP_IDT_ram[EBX].table_linear,EAX
 MOV EBX,EAX
 ADD EAX,ECX
 REP MOVS BYTE PTR ES:[EDI],BYTE PTR DS:[ESI]</pre>
        </div>
      </div>
    </div>


    <div class="mainContent">
        <div class="article largeCard">
	<div class="articleContent largeCardContent">
	    <h1>【译】深入了解CSS自定义属性</h1>
			
	    	<p class="date"><time datetime="2016-04-22T09:25:58.000Z" itemprop="datePublished">2016-04-22</time></p>
			
			
	    	<p class="categories">
				<a class="article-category-link" href="/categories/css/">css</a>
				</p>
	    
	    <div class="articleDetail largeCardDetail">
	    	<div class="markdown">
	    		<blockquote><p>原文链接：<a target="_blank" rel="noopener" href="https://blog.gospodarets.com/css_properties_in_depth">CSS custom properties (native variables) In-Depth</a></p>
<p>原文发布时间：March 29, 2016<br>原作者：Serg Gospodarets</p>
<p>翻译者：IwYvI</p>
</blockquote>
<blockquote><p>这将是我翻译的第一篇文章，主要是关于CSS自定义属性等内容。（这篇文章看上去翻译起来比较简单，（不知道我翻译完了还会不会这么说</p>
</blockquote>
<blockquote><p>词汇翻译：</p>
<ul>
<li>CSS property：CSS属性</li>
<li>CSS custom property：CSS自定义属性</li>
<li>CSS variable：CSS变量</li>
</ul>
<p>翻译这篇文章借助了有道、bing、Google的翻译。如果出现不准确的地方希望能向我提出来</p>
</blockquote>

<p>在这篇文章中，我本想从解释CSS变量的用途开始说起，但是事实上许多流行的CSS预、后处理器已经实现了这个功能</p>
<p>几个用途的例子：</p>
<ul>
<li>颜色变量</li>
<li>组件的常量属性（布局，位置属性等等）</li>
<li>避免代码冗余</li>
</ul>
<p>当然，你仍然可以手动在你的代码库里查找或者替换你所想修改的部分，但是这就像在JS中没有定义变量直接使用硬编码的值一样痛苦。动态的和限定作用域的CSS变量将对你的实验和应用程序提供更多功能：你可以自由地阅读，设置和更新它们！同时你可以避免在代码库中造成代码冗余，你可以看看最近的这篇文章<a target="_blank" rel="noopener" href="https://webkit.org/blog/5989/css-variables-in-webkit/">Webkit guys did in their Web Inspector</a>。</p>
<p>同时你终于有了一个可以轻松地从CSS向JS传递数据的接口（例如媒体断点的值(media breakpoint values)）</p>
<p>下面是CSS属性具有的几个特点：</p>
<ul>
<li>它们是动态的，能在运行时被修改</li>
<li>它们可以轻松地用JS读写</li>
<li>它们是可继承的，层叠的且有作用域</li>
</ul>
<p>下面，让我们深入了解什么是CSS属性和怎么使用它们</p>
<h3 id="名称"><a href="#名称" class="headerlink" title="名称"></a>名称</h3><p>最开始，这项特性被叫做CSS变量，但是后来被扩展和重构为CSS自定义属性</p>
<p>然而，根据它所使用的语法，更准确的名称应该是CSS属性。这篇相关文章<a target="_blank" rel="noopener" href="http://tabatkins.github.io/specs/css-apply-rule/">CSS @apply rule</a>让我们觉得有点”mixins”的感觉。</p>
<p>所以目前的名称是<a target="_blank" rel="noopener" href="https://drafts.csswg.org/css-variables/">CSS Custom Properties for Cascading Variables</a>（CSS层叠变量的自定义属性）。</p>
<p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/CSS/Using_CSS_variables#What_are_CSS_Variables">CSS变量目前有两种形式</a>:</p>
<blockquote>
<p>变量是指一个标识符指代一个任意常规的值。<code>var()</code>符号：<code>var(--example-variable)</code>将返回<code>--example-variable</code>的值。</p>
</blockquote>
<blockquote>
<p>自定义属性是指用<code>--*</code>这样的形式表示的属性，其中<code>*</code>代表变量名称。用这种形式给变量赋值：<code>--example-variable: 20px;</code>，这句话表示将变量<code>--example-variable</code>赋值为<code>20px</code>。</p>
</blockquote>
<h3 id="第一个CSS变量"><a href="#第一个CSS变量" class="headerlink" title="第一个CSS变量"></a>第一个CSS变量</h3><p>或许这会让你惊讶，因为你有可能已经了解并且使用过一个CSS变量（看起来是第一个）<code>currentColor</code>，这个变量虽然并不是众所周知的但是<a target="_blank" rel="noopener" href="https://css-tricks.com/currentcolor/">仍然可以使用</a>并且<a target="_blank" rel="noopener" href="http://caniuse.com/#feat=currentcolor">可以在所有浏览器中工作</a>。</p>
<p>它同样有作用域并且可以被重新定义：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-pseudo">:root</span> &#123; <span class="attribute">color</span>: red; &#125;</span><br><span class="line"><span class="selector-tag">div</span> &#123; <span class="attribute">border</span>: <span class="number">1px</span> solid currentColor; &#125; <span class="comment">/* border-color is red */</span></span><br></pre></td></tr></table></figure>
<p>如果你加上这一句</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: black;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>边框的颜色<a target="_blank" rel="noopener" href="http://codepen.io/malyw/pen/yObLEX">将变回黑色</a></p>
<h3 id="CSS变量的语法"><a href="#CSS变量的语法" class="headerlink" title="CSS变量的语法"></a>CSS变量的语法</h3><h4 id="赋值"><a href="#赋值" class="headerlink" title="赋值"></a>赋值</h4><p>你可以使用<code>--variable-name: variable-value;</code>这个语法来定义一个变量（变量名是大小写敏感的）。而变量的值可以是颜色，字符串等等：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-pseudo">:root</span>&#123;</span><br><span class="line">  --<span class="selector-tag">main</span>-<span class="attribute">color</span>: <span class="number">#4d4e53</span>;</span><br><span class="line">  --<span class="selector-tag">main</span>-bg: <span class="built_in">rgb</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>);</span><br><span class="line">  --logo-<span class="attribute">border-color</span>: rebeccapurple;</span><br><span class="line">  --<span class="selector-tag">header</span>-<span class="attribute">height</span>: <span class="number">68px</span>;</span><br><span class="line">  --<span class="attribute">content</span>-<span class="attribute">padding</span>: <span class="number">10px</span> <span class="number">20px</span>;</span><br><span class="line">  --base-<span class="attribute">line-height</span>: <span class="number">1.428571429</span>;</span><br><span class="line">  --<span class="attribute">transition-duration</span>: .<span class="number">35s</span>;</span><br><span class="line">  --external-link: <span class="string">&quot;external link&quot;</span>;</span><br><span class="line">  --<span class="attribute">margin-top</span>: <span class="built_in">calc</span>(<span class="number">2vh</span> + <span class="number">20px</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>语法似乎看起来很吃藕，但是这是因为<a target="_blank" rel="noopener" href="http://www.xanthir.com/blog/b4KT0">种种原因</a>。例如<code>$var</code>这样的变量语法就会被其他的CSS预处理器处理。</p>
<h4 id="用法"><a href="#用法" class="headerlink" title="用法"></a>用法</h4><p>你可以在CSS像这样用变量：<code>some-css-value: var(--variable-name [, declaration-value]);</code></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="built_in">var</span>(--p-margin, <span class="number">0</span> <span class="number">0</span> <span class="number">10px</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在上面这个例子中如果<code>--p-margin</code>没有被定义，<code>0 0 10px</code>将被使用。这样的特性会让编写的代码更灵活，例如你可以使用一些来自框架的变量（通常多数变量已经被定义了），但是当你要移除它们的时候这个特性将会节约做其他【高端】的事的时间。</p>
<h4 id="作用域"><a href="#作用域" class="headerlink" title="作用域"></a>作用域</h4><p>正如<a target="_blank" rel="noopener" href="https://drafts.csswg.org/css-variables/">module’s documentation title</a>里提到的，自定义属性也遵守<a target="_blank" rel="noopener" href="https://drafts.csswg.org/css-cascade-4/#cascade">CSS层叠规则</a>。</p>
<p>用<a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/CSS/:root"><code>:root scope</code></a>来创建一个全局变量：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-pseudo">:root</span>&#123;</span><br><span class="line">  --global-<span class="selector-tag">var</span>: <span class="string">&#x27;global&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果你想创建一个只在某个元素或组件里存在的变量，就在那个元素里面[重]定义这个变量（<a target="_blank" rel="noopener" href="http://codepen.io/malyw/pen/QNvwRV">demo</a>）：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;block&quot;</span>&gt;</span></span><br><span class="line">  My block is</span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;block__highlight&quot;</span>&gt;</span>awesome<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.block</span> &#123;</span><br><span class="line">  --block-<span class="attribute">font-size</span>: <span class="number">1rem</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="built_in">var</span>(--block-font-size);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.block__highlight</span> &#123;</span><br><span class="line">  --block-highlight-<span class="attribute">font-size</span>: <span class="number">1.5rem</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="built_in">var</span>(--block-highlight-font-size);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>媒体查询同样提供了作用域（<a target="_blank" rel="noopener" href="http://codepen.io/malyw/pen/grgJJJ">demo</a>）：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">min-width</span>: <span class="number">1025px</span>) &#123;</span><br><span class="line">  <span class="selector-pseudo">:root</span> &#123;</span><br><span class="line">    --screen-category: <span class="string">&#x27;desktop&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>下一个关于作用域的例子是<a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/CSS/Pseudo-classes">伪类</a>（例如：<code>:hover</code>）（<a target="_blank" rel="noopener" href="http://codepen.io/malyw/pen/ZWygyv">demo</a>）：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  --bg: <span class="number">#f00</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">var</span>(--bg);</span><br><span class="line">  <span class="attribute">transition</span>: background-color <span class="number">1s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">body</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  --bg: <span class="number">#ff0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当定义了全局的自定义变量，为了避免命名冲突，可以看看这篇文章<a target="_blank" rel="noopener" href="http://codepen.io/malyw/pen/eZgaQv">a common convention naming your variables</a>（或者更简单地用<a target="_blank" rel="noopener" href="http://getbem.com/naming/">BEM naming convention</a>这个方法来命名），例如：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-pseudo">:root</span> &#123;</span><br><span class="line">  <span class="comment">/* main (page-wide) variables */</span></span><br><span class="line">  --<span class="selector-tag">main</span>-<span class="attribute">color</span>: <span class="number">#555</span>;</span><br><span class="line">  --<span class="selector-tag">main</span>-bg: <span class="built_in">rgb</span>(<span class="number">200</span>, <span class="number">200</span>, <span class="number">200</span>);</span><br><span class="line">  <span class="comment">/* accordion variables */</span></span><br><span class="line">  --accordion-bg: <span class="number">#f00</span>;</span><br><span class="line">  --accordion-<span class="attribute">font-size</span>: <span class="number">1.5rem</span>;</span><br><span class="line">  --accordion__item-bg: <span class="number">#ded</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--main-color);</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">var</span>(--main-bg);</span><br><span class="line">  <span class="comment">/*...*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="用其他变量来赋值"><a href="#用其他变量来赋值" class="headerlink" title="用其他变量来赋值"></a>用其他变量来赋值</h4><p>同样我们可以用其他变量来给变量赋值<code>--variable-name: var(--another-variable-name);</code>（<a target="_blank" rel="noopener" href="http://codepen.io/malyw/pen/NNjqWB">demo</a>）：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.block</span> &#123;</span><br><span class="line">  --block-text: <span class="string">&#x27;This is my block&#x27;</span>;</span><br><span class="line">  --block-highlight-text: <span class="built_in">var</span>(--block-text)<span class="string">&#x27; with highlight&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.block</span>:before &#123;</span><br><span class="line">  content: <span class="built_in">var</span>(--block-text);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.block__highlight</span>:before &#123;</span><br><span class="line">  content: <span class="built_in">var</span>(--block-highlight-text); <span class="comment">/*This is my block with highlight*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里有一个小问题，就是不能简单地用已定义的变量来计算出新的变量值。但是我们可以用<a target="_blank" rel="noopener" href="https://developer.mozilla.org/en/docs/Web/CSS/calc"><code>calc()</code></a>来代替（<a target="_blank" rel="noopener" href="http://codepen.io/malyw/pen/GZmJgO">demo</a>）：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.block</span> &#123;</span><br><span class="line">  --block-<span class="attribute">font-size</span>: <span class="number">1rem</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.block__highlight</span> &#123;</span><br><span class="line">  <span class="comment">/* DOESN&#x27;T WORK */</span></span><br><span class="line">  --block-highlight-<span class="attribute">font-size</span>: --block-font-size)*<span class="number">1.5</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="built_in">var</span>(--block-highlight-font-size);</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* WORKS */</span></span><br><span class="line">  <span class="attribute">font-size</span>: <span class="built_in">calc</span>(<span class="built_in">var</span>(--block-font-size)*<span class="number">1.5</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>注意，那些很庞大的表达式可能会影响到应用的性能</p>
<h4 id="使用calc-计算"><a href="#使用calc-计算" class="headerlink" title="使用calc()计算"></a>使用calc()计算</h4><p>上面已经提到你不能像这样使用变量：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">padding</span>: <span class="built_in">var</span>(--spacer)px</span><br></pre></td></tr></table></figure>
<p>但是可以使用<code>calc()</code>来进行计算。让我们做一个<a target="_blank" rel="noopener" href="http://codepen.io/malyw/pen/MymmNK">vertical rhythm</a>（这个怎么翻译嘤嘤嘤）的例子：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">margin</span>: <span class="number">0</span> <span class="number">0</span> <span class="built_in">calc</span>(<span class="built_in">var</span>(--base-line-height, <span class="number">0</span>) * <span class="number">1rem</span>);</span><br></pre></td></tr></table></figure>
<h4 id="重置或继承变量的值"><a href="#重置或继承变量的值" class="headerlink" title="重置或继承变量的值"></a>重置或继承变量的值</h4><p>CSS自定义属性默认是继承的。这种情况下为了减小对块或组件的副作用，你可以<a target="_blank" rel="noopener" href="http://codepen.io/malyw/pen/qZReZB">重置自定义属性</a>：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.with-reset</span> &#123;</span><br><span class="line">  --bgcolor: initial;<span class="comment">/* RESETS VALUE */</span></span><br><span class="line">  --<span class="attribute">color</span>: green;<span class="comment">/* CHANGES VALUE */</span></span><br><span class="line">  --<span class="attribute">border</span>: inherit;<span class="comment">/* DOESN&#x27;T CHANGE ANYTHING, AS INHERITED BY DEFAULT */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="用JavaScript控制自定义属性"><a href="#用JavaScript控制自定义属性" class="headerlink" title="用JavaScript控制自定义属性"></a>用JavaScript控制自定义属性</h3><p>你可以使用JS轻松地读写自定义属性。（<a target="_blank" rel="noopener" href="https://www.w3.org/TR/DOM-Level-2-Style/css.html#CSS-CSSStyleDeclaration">CSS样式声明接口</a>(<code>getPropertyValue</code>,<code>setProperty</code>)）：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// READ</span></span><br><span class="line"><span class="keyword">const</span> rootStyles = getComputedStyle(<span class="built_in">document</span>.documentElement);</span><br><span class="line"><span class="keyword">const</span> varValue = rootStyles.getPropertyValue(<span class="string">&#x27;--screen-category&#x27;</span>).trim();</span><br><span class="line"><span class="comment">// WRITE</span></span><br><span class="line"><span class="built_in">document</span>.documentElement.style.setProperty(<span class="string">&#x27;--screen-category&#x27;</span>, value);</span><br></pre></td></tr></table></figure>
<p>下面是一个DEMO，使用``–screen-category`这个自定义变量代表当前显示类型，它可以在UI界面中被修改。（<a target="_blank" rel="noopener" href="http://codepen.io/malyw/pen/grgJJJ">demo</a>）</p>
<p>这个demo中展示了JS中对自定义变量进行debug的方法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// GET</span></span><br><span class="line">alert(</span><br><span class="line">    getComputedStyle(<span class="built_in">document</span>.documentElement).getPropertyValue(<span class="string">&#x27;--screen-category&#x27;</span>).trim();</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// SET</span></span><br><span class="line"><span class="built_in">document</span>.documentElement.style.setProperty(<span class="string">&#x27;--screen-category&#x27;</span>, <span class="string">&#x27;custom&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// or reassign from an another prop</span></span><br><span class="line"><span class="built_in">document</span>.documentElement.style.setProperty(</span><br><span class="line">    <span class="string">&#x27;--screen-category&#x27;</span>, <span class="string">&#x27;var(--default-screen-category, &#x27;</span>%DEFAULT VALUE IF VAR IS NOT SET%<span class="string">&#x27;)&#x27;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>现在我们能把任意值赋给CSS变量，也有了接口在JS读写这些变量，这样我们就可以摆脱以前使用的<a target="_blank" rel="noopener" href="https://blog.gospodarets.com/passing_data_from_sass_to_js">从CSS/SASS中向JS传递数据</a>这样的方法。（例如：<a target="_blank" rel="noopener" href="http://codepen.io/malyw/pen/zGxodr">list of media queries breakpoints</a>）。</p>
<p>把变量放在<code>content</code>中，将会在页面上输出它的值，这样可以用来做debug：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span>:after &#123;</span><br><span class="line">  content: <span class="string">&#x27;--screen-category : &#x27;</span><span class="built_in">var</span>(--screen-category);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="浏览器支持"><a href="#浏览器支持" class="headerlink" title="浏览器支持"></a>浏览器支持</h3><p>自定义属性已经可以在Chrome，Firefox和桌面版Safari 9.1里正常使用了：</p>
<p><img src="https://i.loli.net/2018/09/08/5b935d2c13e90.jpg" alt="browser_support"></p>
<p style="text-align:center">Stats from <a target="_blank" rel="noopener" href="http://caniuse.com/#feat=css-variables">caniuse.com</a></p>

<p>这个特性在<a target="_blank" rel="noopener" href="https://dev.windows.com/en-us/microsoft-edge/platform/status/cssvariables">Microsoft Edge浏览器里的支持还在考虑中</a></p>
<p>它们目前还有一些限制和bug：</p>
<ul>
<li><a target="_blank" rel="noopener" href="http://codepen.io/malyw/pen/ONmjzp">用<code>calc()</code>计算CSS变量</a>可能会在某些浏览器上出错</li>
<li>人们还在讨论<a target="_blank" rel="noopener" href="https://github.com/w3c/webcomponents/issues/300#issuecomment-144551648">为当前作用域中的自定义属性添加一些基础规则</a>，例如<code>--: initial;</code></li>
<li>不能使用常规CSS属性名称： <del><code>var(--side): 10px;</code></del></li>
<li>用<code>calc()</code>计算时需要这样写：<code>calc(var(--base-line-height, 0) * 1rem)</code></li>
<li>不能当做媒体查询的值 <del><code>@media screen and (min-width: var(--desktop-breakpoint))</code></del></li>
<li>图片的url也不可以使用变量 <del><code>url(var(--image-url))</code></del></li>
</ul>
<p>这里有个<a target="_blank" rel="noopener" href="http://codepen.io/malyw/pen/GZmzPG">DEMO</a>可以用来测试浏览器对CSS自定义属性的支持。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@supports</span> ( (<span class="attribute">--a</span>: <span class="number">0</span>)) &#123;</span><br><span class="line">  <span class="comment">/* supported */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@supports</span> ( <span class="keyword">not</span> (<span class="attribute">--a</span>: <span class="number">0</span>)) &#123;</span><br><span class="line">  <span class="comment">/* not supported */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="built_in">window</span>.CSS &amp;&amp; <span class="built_in">window</span>.CSS.supports &amp;&amp; <span class="built_in">window</span>.CSS.supports(<span class="string">&#x27;--a&#x27;</span>, <span class="number">0</span>)) &#123;</span><br><span class="line">  alert(<span class="string">&#x27;CSS properties are supported&#x27;</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  alert(<span class="string">&#x27;CSS properties are NOT supported&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>对于以前的浏览器（<a target="_blank" rel="noopener" href="http://caniuse.com/#feat=css-featurequeries">没有 CSS.sgpports() API</a>），你可以看看<a target="_blank" rel="noopener" href="https://gist.github.com/wesbos/8b9a22adc1f60336a699">Wes Bos’ test</a>。</p>
<h3 id="Fallbacks-polyfills"><a href="#Fallbacks-polyfills" class="headerlink" title="Fallbacks/polyfills"></a>Fallbacks/polyfills</h3><p>（这个标题似乎并没有什么中文词语能直接翻译，大意就是让老浏览器支持新功能）</p>
<blockquote>
<p>接下来这两段翻译的实在是有些勉强</p>
</blockquote>
<blockquote>
<p>There are couple examples of PostCSS plugins, but <code>no plugin can achieve true complete parity according to the specification because of the DOM cascade unknowns</code> + they are not dynamic.</p>
<p>It might be solved when we see the bright future and CSS Houdini group dream of implementing <a target="_blank" rel="noopener" href="https://www.smashingmagazine.com/2016/03/houdini-maybe-the-most-exciting-development-in-css-youve-never-heard-of/">an easy native way for CSS “polyfills” to all major browsers</a> will come true. And even in that case variables syntax, most of all, cannot be shimmed.</p>
</blockquote>
<p>现在已经有许多关于PostCSS插件的例子，但是这些插件都不能根据规范真正实现对等处理，因为DOM层叠结构对它们是未知的，而且这些插件所做的处理也是非动态的。</p>
<p>这个问题最终将会被解决，CSS Houdini组织提出的<a target="_blank" rel="noopener" href="https://www.smashingmagazine.com/2016/03/houdini-maybe-the-most-exciting-development-in-css-youve-never-heard-of/">an easy native way for CSS “polyfills” to all major browsers</a>，应该会实现，我们也可以看得出CSS广阔的前景。最重要的是在这种情况下，变量语法不再会被忽视。</p>
<p>然而到目前为止有这样一个清单：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/postcss/postcss-custom-properties">转换W3C CSS自定义属性的PostCSS插件</a>- 一个只处理<code>:root</code>里声明的变量的插件</li>
<li><a target="_blank" rel="noopener" href="https://github.com/MadLittleMods/postcss-css-variables">将CSS自定义属性（CSS变量）的语法转换为静态的语句</a>，这有一个<a target="_blank" rel="noopener" href="https://madlittlemods.github.io/postcss-css-variables/playground/">在线的DEMO</a>。它尝试处理了媒体查询、伪类元素和元素嵌套这些部分的作用域问题。</li>
<li><a target="_blank" rel="noopener" href="https://github.com/segmentio/myth">Myth</a>- 一个预处理器</li>
<li><a target="_blank" rel="noopener" href="https://github.com/MoOx/postcss-cssnext">CSS next</a>，为CSS添加新的语法</li>
</ul>
<h3 id="和CSS预处理器（SCSS）一起使用"><a href="#和CSS预处理器（SCSS）一起使用" class="headerlink" title="和CSS预处理器（SCSS）一起使用"></a>和CSS预处理器（SCSS）一起使用</h3><h4 id="相同的变量名"><a href="#相同的变量名" class="headerlink" title="相同的变量名"></a>相同的变量名</h4><p>现在开始和预处理器一起使用CSS自定义属性，我们可以使用<a target="_blank" rel="noopener" href="http://codepen.io/malyw/pen/grRQeq">一种混合语法来检查浏览器的支持</a></p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@supports</span> ( (<span class="attribute">--a</span>: <span class="number">0</span>)) &#123;</span><br><span class="line">  <span class="comment">/* Custom properties are supported in the browser */</span></span><br><span class="line">  <span class="selector-pseudo">:root</span>&#123;</span><br><span class="line">    --<span class="selector-tag">main</span>-bg: <span class="number">#4d4e53</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">body</span> &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: var(--main-bg);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@supports</span> ( <span class="keyword">not</span> (<span class="attribute">--a</span>: <span class="number">0</span>)) &#123;</span><br><span class="line">  <span class="comment">/* Custom properties are NOT supported in the browser */</span></span><br><span class="line">  <span class="variable">$main-bg</span>: <span class="number">#4d4e53</span>;</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">body</span> &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="variable">$main-bg</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在这种情况下CSS和Sass的变量都存在，但是只有在浏览器不支持自定义属性时Sass变量才会被使用。</p>
<p>或者你可以把这种逻辑<a target="_blank" rel="noopener" href="http://codepen.io/malyw/pen/aNwKKv">藏在Sass的mixin中</a>：</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@mixin</span> setVar(<span class="variable">$varName</span>, <span class="variable">$value</span>)&#123;</span><br><span class="line">  <span class="keyword">@include</span> setVarSass(<span class="variable">$varName</span>, <span class="variable">$value</span>);</span><br><span class="line">  <span class="keyword">@include</span> setVarCss(<span class="variable">$varName</span>, <span class="variable">$value</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@mixin</span> setPropFromVar(<span class="variable">$propName</span>, <span class="variable">$varName</span>)&#123;</span><br><span class="line">  <span class="keyword">@supports</span> ( (<span class="attribute">--a</span>: <span class="number">0</span>)) &#123;</span><br><span class="line">    <span class="comment">// Custom properties are supported in the browser</span></span><br><span class="line">    #&#123;<span class="variable">$propName</span>&#125;: getVarCss(<span class="variable">$varName</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">@supports</span> ( <span class="keyword">not</span> (<span class="attribute">--a</span>: <span class="number">0</span>)) &#123;</span><br><span class="line">    <span class="comment">// Custom properties are NOT supported in the browser</span></span><br><span class="line">    #&#123;<span class="variable">$propName</span>&#125;: getVarSass(<span class="variable">$varName</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// SET</span></span><br><span class="line"><span class="keyword">@include</span> setVar(<span class="string">&#x27;main-color&#x27;</span>, <span class="number">#f00</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// GET</span></span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="keyword">@include</span> setPropFromVar(<span class="string">&#x27;color&#x27;</span>, <span class="string">&#x27;main-color&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="全局变量"><a href="#全局变量" class="headerlink" title="全局变量"></a>全局变量</h4><p>在Sass和CSS中变量的作用域是不同的，但是它们都可以这样做：</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* SCSS */</span></span><br><span class="line"><span class="variable">$main-color</span>: <span class="number">#f00</span> !global;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* CSS */</span></span><br><span class="line"><span class="selector-pseudo">:root</span>&#123;</span><br><span class="line">    --<span class="selector-tag">main</span>-<span class="attribute">color</span>: <span class="number">#f00</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="给没有赋值的变量赋值"><a href="#给没有赋值的变量赋值" class="headerlink" title="给没有赋值的变量赋值"></a>给没有赋值的变量赋值</h3><p>一个常见的情况是，我们希望使用一个变量给另一个变量赋值时，如果用于赋值的变量本身没有被赋值，则需要一个默认值来赋给新的变量。</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* SCSS */</span></span><br><span class="line"><span class="variable">$main-color</span>: <span class="number">#f00</span> !default;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">body</span>&#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="variable">$main-color</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然而你并不能在CSS里这样做：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* CSS */</span></span><br><span class="line"><span class="selector-tag">body</span>&#123;</span><br><span class="line">    --<span class="selector-tag">main</span>-<span class="attribute">color</span>: <span class="built_in">var</span>(--main-color, <span class="number">#f00</span>); <span class="comment">/* DOESN&#x27;T WORK */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>但是你可以创建一个新的变量</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* CSS */</span></span><br><span class="line"><span class="selector-tag">body</span>&#123;</span><br><span class="line">    --local-<span class="selector-tag">main</span>-<span class="attribute">color</span>: <span class="built_in">var</span>(--main-color, <span class="number">#f00</span>); <span class="comment">/* DOES WORK */</span></span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--local-main-color);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>或者直接使用</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* CSS */</span></span><br><span class="line"><span class="selector-tag">body</span>&#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--main-color, <span class="number">#f00</span>); <span class="comment">/* DOES WORK */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="有趣的用法"><a href="#有趣的用法" class="headerlink" title="有趣的用法"></a>有趣的用法</h3><p>自定义属性提出了这些有趣的想法：</p>
<ul>
<li>现在可以使用原生的方法来处理CSS与JS的通信，而不是<a target="_blank" rel="noopener" href="https://css-tricks.com/making-sass-talk-to-javascript-with-json/">以前用的hack方法</a></li>
<li>另一个例子是<a target="_blank" rel="noopener" href="http://codepen.io/malyw/pen/grgVGx">国际化地使用自定义属性</a>，不同语言中的text和colors可以使用<code>external link</code>来解决</li>
<li>Jake Archibald 提出了一个想法：根据加载到页面的块和样式，使用CSS变量控制元素的可见性（<a target="_blank" rel="noopener" href="https://jakearchibald.com/2016/css-loading-with-custom-props/">文章链接</a>）</li>
<li>主题切换：现在不必再为特定class添加CSS样式或者增加新的CSS样式文件来改变网站主题，你可以使用自定义属性来解决这个问题。Michael Scharnagl在<a target="_blank" rel="noopener" href="https://justmarkup.com/log/2016/02/theme-switcher-using-css-custom-properties/">这篇文章</a>中描述了如何处理主题切换。</li>
<li>我还想到了一些用法，例如用于特定域名（对 domain1.site.com和domain1.site.com提供不同的外观）（原文如此）。这样我们就可以很轻松上传并应用重定义了自定义属性的CSS文件（取决于域名）</li>
</ul>
<p>最后一个想法很贴近使用自定义属性的主题切换，所以可以把他们放在一起用（<a target="_blank" rel="noopener" href="https://blog.gospodarets.com/demos/css-custom-props-theme-switcher/">demo</a>）</p>
<p><a target="_blank" rel="noopener" href="https://blog.gospodarets.com/demos/css-custom-props-theme-switcher/"><img src="https://i.imgur.com/DwLCfC0.gif"></a></p>
<ul>
<li>当然，自定义属性在<a target="_blank" rel="noopener" href="http://codepen.io/malyw/pen/KzZXRq?editors=1100">补全CSS属性</a>这里看起来也很好用</li>
</ul>
<p><a target="_blank" rel="noopener" href="http://codepen.io/malyw/pen/KzZXRq?editors=1100"><img src="https://i.imgur.com/E0FTuI1.jpg"></a></p>
<h3 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h3><p>受到Wes Bos <a target="_blank" rel="noopener" href="https://twitter.com/wesbos/status/697808716905652224">demos of interacting with CSS custom properties</a>的启发，我决定更进一步在CSS中使用<code>calc();</code>对颜色的R,G,B值进行计算。</p>
<p>这是灰度过滤器的代码：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.grayscale</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(</span><br><span class="line">    <span class="built_in">calc</span>(<span class="number">0.2126</span> * <span class="built_in">var</span>(--r)),</span><br><span class="line">    <span class="built_in">calc</span>(<span class="number">0.7152</span> * <span class="built_in">var</span>(--g)),</span><br><span class="line">    <span class="built_in">calc</span>(<span class="number">0.0722</span> * <span class="built_in">var</span>(--b)),</span><br><span class="line">    <span class="number">1</span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://blog.gospodarets.com/demos/css-colors-from-custom-props/">DEMO</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.gospodarets.com/demos/css-colors-from-custom-props/"><img src="https://i.imgur.com/9IUE3FR.gif"></a></p>
<p>有趣的事实：</p>
<ul>
<li>Chrome似乎并不喜欢<code>calc()</code>中的CSS变量的非整数乘除法</li>
<li>Firefox完全不计算<code>rgba()</code>里面需要使用<code>calc()</code>计算的自定义变量</li>
<li>Demo在Safari里能达到预期效果O(∩_∩)O~~（原本是个emoji表情）</li>
</ul>
<h3 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h3><p>现在你应该已经知道了CSS自定义变量的含义和如下几点：</p>
<ul>
<li>它的语法支持CSS和JS的交互</li>
<li>它是动态的、可继承的、层叠的和有作用域的</li>
<li>浏览器的支持和它的fallbacks</li>
<li>它可以和Sass变量一起使用</li>
<li>总之，通过一些有趣的用法和示例，自定义属性确实为开发者和web平台加入了新的能力</li>
</ul>
<p>我希望读完这篇文章后你能用上自定义属性</p>
<h3 id="扩展阅读"><a href="#扩展阅读" class="headerlink" title="扩展阅读"></a>扩展阅读</h3><p>近期CSS原生mixins语法发布 - <a href="http://www.iwyvi.com/css/css-apply-rule">【译】CSS @apply规则(mixins)</a></p>
<blockquote>
<p>原文链接：<a target="_blank" rel="noopener" href="https://blog.gospodarets.com/css_properties_in_depth">CSS custom properties (native variables) In-Depth</a></p>
<p>原文发布时间：March 29, 2016</p>
<p>原作者：Serg Gospodarets</p>
<p>翻译者：IwYvI</p>
<p>翻译时间：2016/4/22</p>
<p>第一次翻译英语文章，如有不准确的地方希望向我提出来</p>
</blockquote>

	    	</div>
	    </div>
  	</div>
</div>




	<div class="largeCard comments">
		<div class="largeCardContent commentsContent">
			<div id="disqus_thread">Disqus Comments</div>
		</div>
	</div>
	<script>
		/**
		* RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
		* LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
		*/
		/*
		var disqus_config = function () {
		this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable
		this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
		};
		*/
		(function() { // DON'T EDIT BELOW THIS LINE
		var d = document, s = d.createElement('script');
		s.src = 'https://iwyvi.disqus.com/embed.js';
		s.setAttribute('data-timestamp', +new Date());
		(d.head || d.body).appendChild(s);
		})();
		</script>
		<noscript>Please enable JavaScript to view the <a target="_blank" href="//disqus.com/?ref_noscript" rel="nofollow noopener">comments powered by Disqus.</a></noscript>







    </div>

      </div>
  <div class="footer">
    <div class="link">
      
        <a target="_blank" rel="noopener" href="https://github.com/iwyvi"><img src="/img/github.png" alt="github" height="32" width="32" alt=""></a>
      
    </div>
    <div class="copyright">
      <p>Copyright © 2016-2021. Content By <a target="_blank" rel="noopener" href="https://github.com/iwyvi">iwyvi</a>. All Rights Reserved.
      </p>
      <p>Theme By <a target="_blank" rel="noopener" href="https://github.com/iwyvi">iwyvi</a></p>
    </div>
  </div>
</div>
<div class="bottom"></div>
    <span style="display: none;">
  <script src="https://s4.cnzz.com/z_stat.php?id=1259030304&web_id=1259030304" language="JavaScript"></script>
</span>
  </body>

</html>
